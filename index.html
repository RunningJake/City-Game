<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>City Guess</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#07131a">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Background silhouettes layer (behind UI) -->
  <div class="bg-silhouettes" aria-hidden="true"></div>

  <div id="app" class="app">
    <header class="topbar">
      <div class="brand">
        <span class="logo">‚òÖ</span>
        <span class="title">City Guess</span>
      </div>

      <div class="row" style="gap:10px">
        <div id="mascots" aria-hidden="true">ü¶ï ü¶≠ üêâ</div>
        <button id="btnReset" class="btn btn-ghost" title="Reset game">Reset</button>
      </div>
    </header>

    <main class="panel">
      <!-- HOME -->
      <section id="screenHome" class="screen">
        <div class="card hero">
          <h1 class="h1">City Guess</h1>
          <p class="muted">Two-phones online multiplayer ‚Ä¢ local pass-and-play ‚Ä¢ solo vs CPU.</p>
        </div>

        <div class="card">
          <h2 class="h2">Online Multiplayer</h2>
          <p class="muted">Two phones. Create a room, share the code, play live.</p>
          <div class="grid2">
            <button id="btnCreateRoom" class="btn btn-primary btn-block">Create Room</button>
            <button id="btnJoinRoom" class="btn btn-secondary btn-block">Join Room</button>
          </div>
          <p class="muted tiny">Room: <span id="roomLabel">‚Äî</span> ‚Ä¢ Role: <span id="roleLabel">‚Äî</span> ‚Ä¢ <span id="onlineStatus">Firebase: ‚Äî</span></p>
        </div>

        <div class="card">
          <h2 class="h2">Vs CPU</h2>
          <p class="muted">Play against the computer. In CPU mode, you select questions from a list so the CPU always understands.</p>
          <label class="field">
            <span>Difficulty</span>
            <select id="cpuDifficulty">
              <option value="easy">Easy</option>
              <option value="medium" selected>Medium</option>
              <option value="hard">Hard</option>
            </select>
          </label>
          <button id="btnStartCpu" class="btn btn-primary btn-block">Start vs CPU</button>
        </div>

        <div class="card">
          <h2 class="h2">Local (one phone)</h2>
          <p class="muted">Pass-and-play on one device.</p>
          <button id="btnStartLocal" class="btn btn-secondary btn-block">Start Local</button>
        </div>

        <div class="card">
          <h2 class="h2">How to play</h2>
          <ol class="muted" style="line-height:1.55">
            <li>Each side picks a secret city.</li>
            <li>Take turns asking yes/no questions.</li>
            <li>Make a guess anytime on your turn.</li>
          </ol>
        </div>
      </section>

      <!-- SETUP -->
      <section id="screenSetup" class="screen hidden">
        <div class="card">
          <div class="row">
            <h1 class="h1" style="margin:0">Setup</h1>
            <div class="pill tiny">Mode: <strong id="modeLabel">‚Äî</strong> ‚Ä¢ Room: <strong id="roomLabel2">‚Äî</strong></div>
          </div>
          <p class="muted" id="setupHint">‚Äî</p>
        </div>

        <div class="card">
          <h2 class="h2">Player names</h2>
          <div class="grid2">
            <label class="field">
              <span>Player 1</span>
              <input id="p1Name" maxlength="18" placeholder="Player 1" />
            </label>
            <label class="field">
              <span>Player 2</span>
              <input id="p2Name" maxlength="18" placeholder="Player 2" />
            </label>
          </div>
        </div>

        <div class="card">
          <h2 class="h2">Secret cities</h2>
          <p class="muted tiny">In CPU mode, you must choose your city from the built-in list so the CPU can guess it.</p>

          <div class="stack">
            <button id="btnSetP1" class="btn btn-secondary btn-block">Set Player 1 City</button>
            <button id="btnSetP2" class="btn btn-secondary btn-block">Set Player 2 City</button>
          </div>

          <div class="grid2 gap-top">
            <div class="pill">P1 city: <strong id="p1CityStatus">not set</strong></div>
            <div class="pill">P2 city: <strong id="p2CityStatus">not set</strong></div>
          </div>

          <button id="btnBeginGame" class="btn btn-primary btn-block gap-top" disabled>Begin Game</button>
          <button id="btnBackHome" class="btn btn-ghost btn-block">Back</button>
        </div>
      </section>

      <!-- GAME -->
      <section id="screenGame" class="screen hidden">
        <div class="card">
          <div class="row">
            <div>
              <div class="muted tiny">Turn</div>
              <div class="h2" id="turnLabel">‚Äî</div>
            </div>
            <div class="right">
              <div class="muted tiny">Phase</div>
              <div class="h2" id="phaseLabel">‚Äî</div>
            </div>
          </div>

          <div class="divider"></div>

          <div id="askArea" class="stack">
            <h2 class="h2">Ask a yes/no question</h2>

            <!-- Free-text question input (Local + Online) -->
            <div id="freeQuestionBlock">
              <label class="field">
                <span>Question</span>
                <input id="questionInput" maxlength="80" placeholder="e.g., Is your city coastal?" />
              </label>

              <div class="grid2">
                <button id="btnAsk" class="btn btn-primary btn-block">Ask</button>
                <button id="btnQuick" class="btn btn-secondary btn-block">Quick Qs</button>
              </div>

              <button id="btnGuess" class="btn btn-ghost btn-block">Make a guess</button>
            </div>

            <!-- Structured question select (CPU mode) -->
            <div id="cpuQuestionBlock" class="hidden">
              <label class="field">
                <span>Select a question</span>
                <select id="cpuQuestionSelect"></select>
              </label>

              <div class="grid2">
                <button id="btnCpuAsk" class="btn btn-primary btn-block">Ask</button>
                <button id="btnQuickCpu" class="btn btn-secondary btn-block">Quick Qs</button>
              </div>

              <button id="btnGuessCpu" class="btn btn-ghost btn-block">Make a guess</button>
              <p class="muted tiny">Tip: CPU mode uses structured questions so ‚Äúunsupported‚Äù never steals your turn.</p>
            </div>
          </div>

          <div id="answerArea" class="stack hidden">
            <h2 class="h2">Answer</h2>
            <div class="bubble" id="questionDisplay">‚Äî</div>
            <div class="grid2">
              <button id="btnYes" class="btn btn-primary btn-block">Yes</button>
              <button id="btnNo" class="btn btn-danger btn-block">No</button>
            </div>
          </div>

          <div id="guessArea" class="stack hidden">
            <h2 class="h2">Make a guess</h2>
            <label class="field">
              <span>Your guess</span>
              <input id="guessInput" maxlength="60" placeholder="Type the city..." />
            </label>
            <div class="grid2">
              <button id="btnSubmitGuess" class="btn btn-primary btn-block">Submit</button>
              <button id="btnCancelGuess" class="btn btn-ghost btn-block">Cancel</button>
            </div>
            <p class="muted tiny">Tip: spelling doesn't have to be perfect‚Äîclose matches are accepted.</p>
          </div>

          <div id="endArea" class="stack hidden">
            <h2 class="h2">Game Over</h2>
            <div class="bubble" id="endMessage">‚Äî</div>
            <button id="btnPlayAgain" class="btn btn-primary btn-block">Play again (new cities)</button>
          </div>
        </div>

        <div class="card">
          <div class="row">
            <h2 class="h2">Log</h2>
            <button id="btnClearLog" class="btn btn-ghost tinybtn">Clear</button>
          </div>
          <div id="log" class="log"></div>
        </div>
      </section>

      <!-- MODAL: enter secret city -->
      <div id="modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-card">
          <div class="row">
            <div class="h2" id="modalTitle">Enter secret city</div>
            <button id="btnCloseModal" class="btn btn-ghost tinybtn" aria-label="Close">‚úï</button>
          </div>
          <p class="muted tiny" id="modalHint">Make sure the other player isn't looking üëÄ</p>
          <label class="field">
            <span>City</span>
            <input id="secretCityInput" maxlength="60" placeholder="e.g., Montevideo" autocomplete="off" />
          </label>

          <!-- Only shown in CPU mode -->
          <div id="cpuCityPicker" class="hidden">
            <p class="muted tiny" style="margin:6px 0 10px">Or pick from the city list:</p>
            <select id="cpuCitySelect"></select>
          </div>

          <div class="grid2">
            <button id="btnSaveCity" class="btn btn-primary btn-block">Save</button>
            <button id="btnCancelCity" class="btn btn-ghost btn-block">Cancel</button>
          </div>
        </div>
      </div>

      <!-- MODAL: quick questions -->
      <div id="quickModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="quickTitle">
        <div class="modal-card">
          <div class="row">
            <div class="h2" id="quickTitle">Quick Questions</div>
            <button id="btnCloseQuick" class="btn btn-ghost tinybtn" aria-label="Close">‚úï</button>
          </div>
          <p class="muted tiny">Tap to insert a question.</p>
          <div id="quickList" class="quicklist"></div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <span class="muted tiny">Offline-ready ‚Ä¢ Add to Home Screen for a real ‚Äúapp‚Äù feel</span>
    </footer>
  </div>

  <!-- Firebase (optional): only needed for Online mode -->
  <script src="firebase.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js').catch(()=>{}));
    }
  </script>
</body>
</html>
